# acestream-appimage
Сдесь собраны мои bash скрипты, и рецепт для сборки AppImage пакета  сервера ***AceStream*** в ***pkg2appimage***. Скрипт, с помощью Docker контейнера на базе
docker имеджа debian:9-slim, билдит AppImage файл содержащий в себе 
[`AceStream-3.1.49`](https://download.acestream.media/linux/acestream_3.1.49_debian_9.9_x86_64.tar.gz), 
взятый на официальном ресурсе [wiki.acestream.media](https://wiki.acestream.media/Download).

Основная боль запуска этого сервера - зависимости `python2.7`, который выпилен на большинстве современных 
десктопных linux операционных системах. 
Причина по которой решил билдить в Docker контейнере - лень разбираться с `libselinux`, которая, на моей хостовой 
машине с Debian 11, не позволяла корректно упаковывать appimage. Так же по причине лени не стал добиваться возможности работы скрипта без прав `root`. 
Скрипты простые, и не сложно увидеть, что `sudo` используется только для простых операций с файлами, которые создаются в docker volume и владелец у них 
пользователь `root`.
При запуске docker контейнера пришлось использовать ключ `--privileged`. Без этого не работал `fuse` внутри контейнера. В общем это вроде и дыра в безопасности, 
но так как все компоненты проекта OpenSouce, то не критично.
Файл [`pkg2appimage.appimage`](https://github.com/AppImage/pkg2appimage) взят из официального репозитория на GitHub.

Для удобства создал два скрипта, которые запускают и останавливают соответсвтвенно сам сервер AceStream. Тоесть в этом проекте можно создать, 
сразу запустить и пользоваться сервером AceStream.
Предусмотрена возможность работы сервера только в режиме `--client-console`, но как по мне этого вполне достаточно.
Весь проект весит ***не больше 100 мб***, при этом пакет сервера весит в районе ***51 мб***. но в процессе билда понадобится не менее 500-700 мб 
свободного места на диске. Стоит отметить, что скрипт удаляет после себя и docker контейнер и docker имедж и ненужные файлы после билда.

Работа со скриптами предельно проста.
Для создания appimage пакета с AceStream сервером нужно, находять в директории проекта, запустить скрипт:
```
  ./start-create-appimage.sh
```
И дождаться окончания создания файла. В процессе выполнения в консоль будет выводиться много информации, что поможет сразу выяснить причины ошибок, 
если такие возникнут. В случае отсутствия ошибок, будет отображена информация об успешном завершении работы скрипта, и где можно найти созданный файл AppImage.

После успешного билда можно сразу его запустить с помощью скрипта:
```
  ./acestream-server-run.sh
```
Этот скрипт запустит сервер и отобразит ссылку, по которой можно посмотреть WEB UI сервера, а так же попытается сразу открыть 
WEB UI в браузере Google Chrome или Firefox.

Для завершения работы сервера можно использовать скрипт:
```
  ./terminate-acestream-server.sh
```
После его запуска отобразится информация о запущеном процессе `acestreamengine` с его ключами запуска, и после завершения этого процесса отобразится 
информация об его отсутствии.
